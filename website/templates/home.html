{% extends 'layout.html' %}

{% block title %}Home{% endblock %}


{% block content %}
<!-- Edit content here -->
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/home.css') }}" />


<!-- Include Scripts -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script src="{{ url_for('static', filename='js/datepicker_handler.js') }}"></script>
<script src="{{ url_for('static', filename='js/navbar_opacity.js') }}"></script>
<script src="{{ url_for('static', filename='js/update_fac_list.js') }}"></script>
<!-- Include jQuery UI -->
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>


<div class="main-graphic" id="main-graphic">
    <img src="{{ url_for('static', filename='assets/football_pitch_dark.jpg') }}", alt="Client main site image"/>
    <div class="img-overlay">
        <h1>
            reserve your time.
        </h1>
    </div>
</div>
{% if data %}
<div class="search-bar-wrap" id="search-bar">
    <div class="search-bar">
        <input type="text" id="search" oninput="performSearch()" placeholder="What are you looking for today ?...">
        <!-- <input type="text" id="datepicker_1" placeholder="Select a date"> -->
        <!-- <button>search</button> -->
    </div>
</div>

<div class="container" id="container">
    {% for d in data %}
        <a class="facilities_id" onclick="reserveFacility('{{d.id_facility}}')">
            <form id="reserveForm" method="GET" action="/reserve">
                <input type="hidden" name="id_facility" value="{{d.id_facility}}">
            </form>
            <script>
                function reserveFacility(id) {
                    window.location.href = "/reserve?id_facility=" + id;
                }
            </script>
            <div class="facilities">
                <div class="facil_image">
                    {% if d['images'] %}
                        <img src="{{ url_for('static', filename='images/' + d['images'][0]['image_path']) }}">
                    {% else %}
                        <img src="{{ url_for('static', filename='assets/no_image.jpg') }}" alt="no image available">
                    {% endif %}
                </div>
                <div class="facil_info">
                        <strong id="facil_name_strong">{{ d['name'] }}</strong>
                        <output>{{ d['address']['city']['name'] }}</output>
                        <output>{{ d['address']['street_name'] }} {{d['address']['building_number']}}</output>
                        <output>{{ d['address']['postal_code'] }}, {{ d['address']['state']['name'] }}</output>
                </div>
                {% if user_data %}
                    {% if user_data.user_role.id_user_role == 2 %}
                <form method="POST" action="/upload_facility_image" enctype="multipart/form-data">
                    <input type="file" name="file" accept=".jpg, .jpeg, .png, .gif">
                    <input type="submit" value="Upload">
                    <input type="hidden" name="id_facility" value="{{d.id_facility}}">
                </form>
                <form method="GET" action="/edit_facility">
                    <input type="submit" value="Edit">
                    <input type="hidden" name="id_facility" value="{{d.id_facility}}">
                </form>
                <form method="POST" action="/delete_facility">
                    <input type="submit" value="Delete">
                    <input type="hidden" name="id_facility" value="{{d.id_facility}}">
                </form>
                    {% endif %}
                {% endif %}
            </div>
        </a>
    {% endfor %}
</div> 

{% endif %}
{% endblock %}



